# 虚拟宠物系统 - 撒娇卖萌功能

## 🐾 功能介绍

新增的撒娇卖萌功能让您的虚拟宠物更加生动可爱！当您一段时间没有关注宠物时，它会主动撒娇求关注，就像真正的宠物一样。

## ✨ 功能特性

### 1. 智能关注检测
- **自动监测**：系统会自动记录您最后一次与宠物互动的时间
- **关注阈值**：默认15分钟没有互动就会触发撒娇
- **互动记录**：喂食、玩耍、休息、打开弹窗都算作关注行为

### 2. 个性化撒娇消息
根据不同宠物类型显示不同的撒娇消息：

#### 🐱 猫咪
- "🐱 喵~ 主人，我想你了！"
- "🐾 主人不理我了吗？我好孤单..."
- "😿 喵呜~ 陪我玩一会儿嘛~"
- "🥺 主人，我乖乖的，你看看我好不好？"

#### 🐶 小狗
- "🐶 汪汪~ 主人，我想你了！"
- "🐕 主人，陪我玩球球好不好？"
- "🥺 汪~ 我一直在等你呢！"
- "😊 主人，我今天很乖哦！"

#### 🐉 龙
- "🐉 吼~ 伟大的主人，小龙想念您了！"
- "✨ 主人，我的魔法需要您的关注才能发光！"
- "🔥 呼~ 主人，我为您守护了很久！"
- "💎 主人，我收集了闪亮的宝石想给您看！"

#### 🐰 兔子
- "🐰 主人，小兔子想要胡萝卜~"
- "🥕 蹦蹦~ 主人，陪我跳跳好不好？"
- "😊 主人，我的耳朵在等你摸摸！"
- "🌸 主人，我找到了好看的花花！"

#### 🐦 小鸟
- "🐦 啾啾~ 主人，我想唱歌给你听！"
- "🎵 主人，我学了新的歌曲哦！"
- "🪶 主人，摸摸我漂亮的羽毛吧！"
- "🌤️ 啾~ 主人，今天天气真好，一起飞翔吧！"

### 3. 丰富的动画效果

#### 按钮动画
- **弹跳动画**：可爱的上下弹跳
- **摇摆动画**：左右摇摆吸引注意
- **脉冲动画**：放大缩小的心跳效果
- **摆动动画**：轻微的旋转摆动

#### 视觉效果
- **发光效果**：按钮会发出粉色光晕
- **爱心标记**：按钮旁边会出现💕符号
- **渐变通知**：美丽的渐变色通知消息

### 4. 智能交互
- **点击响应**：点击撒娇通知可直接打开宠物界面
- **自动重置**：与宠物互动后自动重置关注时间
- **防重复**：避免频繁撒娇，保持良好体验

## 🎮 使用方法

### 正常使用
1. **启用插件**：确保虚拟宠物系统已启用
2. **正常互动**：定期喂食、玩耍、休息
3. **等待撒娇**：15分钟不理宠物，它就会开始撒娇
4. **回应关注**：点击通知或与宠物互动即可

### 测试功能
在浏览器控制台中使用以下命令：

```javascript
// 立即触发撒娇效果
testPetAttentionSeeker()

// 检查撒娇系统状态
checkAttentionStatus()

// 重置关注时间（模拟长时间未关注）
resetAttentionTime()
```

## ⚙️ 配置选项

### 时间设置
- **撒娇阈值**：默认15分钟，可在代码中修改
- **检查频率**：每2分钟检查一次
- **动画持续**：撒娇状态持续3分钟

### 自定义修改
如需修改撒娇阈值，可在代码中找到：
```javascript
// 配置：多长时间没关注就开始撒娇（默认15分钟）
const attentionThreshold = 15 * 60 * 1000; // 15分钟
```

## 🔧 技术实现

### 核心组件
1. **时间追踪**：`lastAttentionTime` 记录最后关注时间
2. **定时检查**：`attentionTimer` 定期检查是否需要撒娇
3. **消息系统**：`attentionMessages` 存储各种撒娇消息
4. **动画引擎**：CSS动画 + JavaScript控制

### 数据存储
- 关注时间存储在 `localStorage` 中
- 页面刷新后自动恢复状态
- 卸载时自动清理相关数据

### 性能优化
- 使用高效的定时器管理
- 动画使用CSS3硬件加速
- 防止重复触发和内存泄漏

## 🎨 自定义样式

### 修改动画效果
在 `style.css` 中可以自定义动画：

```css
/* 修改弹跳高度 */
@keyframes bounce {
    40%, 43% {
        transform: translate3d(0, -12px, 0); /* 原来是-8px */
    }
}

/* 修改发光颜色 */
@keyframes attention-glow {
    50% {
        box-shadow: 0 0 25px rgba(135, 206, 235, 1); /* 改为蓝色 */
    }
}
```

### 修改撒娇消息
在 `index.js` 中的 `attentionMessages` 对象中添加或修改消息。

## 🐛 故障排除

### 撒娇功能不工作
1. **检查插件状态**：确保插件已启用
2. **检查定时器**：运行 `checkAttentionStatus()` 查看状态
3. **手动测试**：运行 `testPetAttentionSeeker()` 测试
4. **重启定时器**：禁用后重新启用插件

### 动画效果异常
1. **检查CSS加载**：确保 `style.css` 正确加载
2. **浏览器兼容**：使用现代浏览器
3. **清除缓存**：刷新页面清除缓存
4. **检查冲突**：禁用其他可能冲突的扩展

### 通知不显示
1. **检查toastr**：确保SillyTavern的通知系统正常
2. **检查设置**：确认通知功能已启用
3. **手动触发**：使用测试命令验证

## 📊 状态监控

### 查看详细状态
```javascript
// 获取完整状态信息
const status = checkAttentionStatus();
console.log(status);
```

### 状态信息包括
- `lastAttentionTime`：最后关注时间戳
- `minutesSinceLastAttention`：距离上次关注的分钟数
- `isShowingAttentionSeeker`：是否正在撒娇
- `timerRunning`：定时器是否运行中

## 🔮 未来改进

### 计划功能
1. **情绪系统**：根据宠物状态调整撒娇频率
2. **学习能力**：记住用户习惯，智能调整撒娇时机
3. **更多动画**：增加更丰富的撒娇动作
4. **声音效果**：添加可爱的撒娇音效
5. **个性化**：允许用户自定义撒娇消息和时间

### 用户建议
如果您有好的想法或建议，欢迎：
1. 在GitHub Issues中提出
2. 贡献代码改进功能
3. 分享您的使用体验

---

**享受与您的虚拟宠物的互动时光！** 🐾💕
